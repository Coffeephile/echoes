(function(){function e(e){this.cv_views=[],this.$target=e.view.target?e.$(e.view.target):e.$el;if(e.collection)return;this._sourceRender=e.render||function(){},e.view&&e.view.collection?this.collection=new e.view.collection:this.collection=new n.Collection}var t=this._,n=this.Backbone;if(!t||!n||!JSON)return;e.prototype={render:function(){this.resetViews(),this.cv_views=this.collection.map(this.createItem,this),this.$target.append(t.map(this.cv_views,this.prepareItem,this)),this.trigger("render:collection")},createItem:function(e){var t=this.view.type;return new t({model:e})},prepareItem:function(e,n){return t.each(this.view.events,function(t,n){this.listenTo(e,n,this[t])},this),e.render().el},_listenToLastestView:function(e,t){this.cv_views[this._currentViewIndex]&&this.listenTo(this.cv_views[this._currentViewIndex],t,this[e])},renderItem:function(e){var n=this.cv_views.length,r=this.view.type;this.cv_views.push(this.createItem(e)),this.$target.append(this.prepareItem(t.last(this.cv_views),n))},addItems:function(e){var n=t.map(e,this.createItem,this);return this.$target.append(t.map(n,this.prepareItem,this)),this},resetViews:function(){t.each(this.cv_views,function(e){this.stopListening(e)},this),t.invoke(this.cv_views,"remove"),this.cv_views.length=0},_hide:function(){this.$el.removeClass(this.transition.css)},_show:function(){this.$el.addClass(this.transition.css)}};var r=function(){n.trigger("extend:View",{key:"view",extension:e,initialize:function(){this.listenTo(this.collection,"reset destroy remove sort",function(){this.render()}),this.listenTo(this.collection,"add",function(e){this.renderItem(e)})}})};r(),n.on("xManager:ready",r)})();