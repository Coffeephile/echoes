define(["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({collection:null,view:null,transition:{duration:200,css:"transition-in"},hide:function(){this.$el.removeClass(this.transition.css)},show:function(){this.$el.addClass(this.transition.css)},render:function(){return this.transition?this.$el.hasClass(this.transition.css)?(this.hide(),this._timer=setTimeout(t.bind(this.renderCollection,this),this.transition.duration)):this.renderCollection():this.renderCollection(),this},renderCollection:function(){this.resetViews(),this.$el.empty(),this.collection.each(function(e){var t=this.cv_views.length;this.cv_views.push(new this.view({model:e})),this.delegateBroadcasts(this.cv_views[t]),this.$el.append(this.cv_views[t].render().el)},this),this.transition&&(clearTimeout(this._timer),this._timer=setTimeout(t.bind(this.show,this),this.transition.duration))},delegateBroadcasts:function(e){t.each(this.broadcasts,function(t,n){e.on(n,this[t],this)},this)},resetViews:function(){t.invoke(this.cv_views,"remove"),this.cv_views=[]},update:function(e){this.collection.reset(e)}}),i=r.extend,s=function(){this.collection=new this.collection,this.listenTo(this.collection,"reset",this.render),this.cv_views=[]};return r.extend=function(e){var t=e.initialize||function(){},n=e.broadcasts;return this.instance=[],e.initialize=function(){s.apply(this,arguments),n&&(this.broadcasts=n),t.apply(this,arguments)},i.call(r,e)},n.CollectionView=r,r});