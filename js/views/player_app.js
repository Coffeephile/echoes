define(["jquery","underscore","backbone","views/media_search","views/youtube_player","views/youtube_search_results","views/results_navigation","models/youtube_media_provider","collections/history_playlist"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({initialize:function(){this.modules={},this.modules.search=new r,this.modules.search.on("search-request",this.onNewSearch,this),this.modules.mediaProvider=new u,this.modules.mediaProvider.on("new-media-response",this.onYoutubeSearchResponse,this),this.modules.youtubePlayer=new i,this.modules.resultsView=new s,this.modules.resultsView.on("search-result-selected",this.onMediaAddedToQueue,this),this.modules.resultsNav=new o,this.modules.resultsNav.on("navigate-index-change",this.onSearchResultsIndexChange,this),this.modules.historyPlaylistData=new a},renderExplore:function(){return this.modules.mediaProvider.set("query",this.modules.search.getQuery()),this.modules.mediaProvider.validateQuerySearch(),this},renderHistory:function(){return this.modules.resultsView.update(this.modules.historyPlaylistData.toJSON().reverse()),this.toggleViews(!1,this.modules.resultsNav,this.modules.search),this},onYoutubeSearchResponse:function(e){this.toggleViews(!0,this.modules.resultsNav,this.modules.search),this.modules.resultsView.update(e.items),this.modules.resultsNav.update(e)},onNewSearch:function(e){this.modules.mediaProvider.set("query",e)},onSearchResultsIndexChange:function(e){this.modules.mediaProvider.set("startIndex",e)},onMediaAddedToQueue:function(e){this.modules.youtubePlayer.play(e),this.modules.historyPlaylistData.queue(e)},toggleViews:function(e){t.each(Array.prototype.slice.call(arguments,1),function(t){t.$el.toggleClass("hidden",!e)})}});return f})