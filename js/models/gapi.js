define(["jquery","underscore","backbone"],function(e,t,n){var r="AIzaSyCgrK5ds9uCSRM-WBUFm8V8jPX66q8-Od0",i={apiKey:r,client_id:"971861197531",scopes:"https://www.googleapis.com/auth/youtube"},s=n.Model.extend({clientId:function(){return i.client_id},defaults:{q:"eric clapton",part:"snippet",maxResults:24},methods:{list:{},update:{},insert:{},"delete":{}},connect:function(){return window.gapi&&gapi.client&&gapi.client.setApiKey?this.auth():(window.onGapiLoad=t.bind(this.onGapiLoad,this),require(["https://apis.google.com/js/client.js?onload=onGapiLoad"],function(){}),this)},onGapiLoad:function(){this.trigger("load:gapi"),gapi.client.setApiKey(r),this.auth()},immediate:!0,auth:function(){gapi.auth.authorize({client_id:i.client_id,scope:this.scopes,immediate:this.immediate},t.bind(this.handleAuthResult,this))},handleAuthResult:function(e){if(e&&!e.error){var i=function(){this.trigger("load:client"),n.trigger("gapiload:youtube")};gapi.client.setApiKey(r),gapi.client.load(this.client.api,this.client.version,t.bind(i,this)),this.trigger("auth:success",e)}},url:function(){return gapi.client.youtube.search},sync:function(){return n.GapiSync.apply(this,arguments)},fetch:function(e){this.sync("read",this,e)},create:function(e){this.sync("create",this,e)},update:function(e){this.sync("update",this,e)}});n.GapiSync=function(e,n,r){function l(){a.execute(r.success),n.trigger("request",n,a,r),n.off("auth:success",l)}var i=t.result(this,"url"),s=o[e],a=i[s](this.methods[s]);r=r||{};var f=r.success;return r.success=function(e){if(e.error)return n.trigger("req:error",n,e,r),e.error;if(!n.set(n.parse(e,r),r))return!1;f&&f(n,e,r),n.trigger("sync",n,e,r)},u[e]?(this.off("auth:success",l),this.on("auth:success",l,this),this.auth()):l(),a};var o={create:"insert",update:"update","delete":"delete",read:"list"},u={create:!0,update:!0,"delete":!0};return s});